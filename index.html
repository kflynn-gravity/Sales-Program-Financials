<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Model Comparison</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
        .chart-container {
            display: flex;
            flex-direction: column;
            width: 100%;
        }
        @media (min-width: 1024px) {
            .chart-container {
                flex-direction: row;
                justify-content: space-between;
            }
            .chart-wrapper {
                width: 48%;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-4">
    <div class="bg-white rounded-xl shadow-2xl p-8 mx-auto my-8">
        <h1 class="text-3xl font-bold text-gray-800 text-center mb-6">Financial Model Comparison: 10-Rep vs. 6-Rep Cohort</h1>
        <p class="text-lg text-center text-gray-600 mb-8">This comparison highlights the break-even points and long-term ROI for two different cohort sizes, showing why a smaller, strategic team is the most efficient choice.</p>
        
        <div class="chart-container">
            <!-- Chart for 10-Rep Cohort -->
            <div class="chart-wrapper relative p-4 mb-8 lg:mb-0">
                <h2 class="text-xl font-bold text-gray-700 text-center mb-4">10-Rep Cohort Model</h2>
                <div class="relative h-[400px]">
                    <canvas id="chart10Reps"></canvas>
                    <div id="infoBox10" class="absolute top-4 left-4 p-4 bg-gray-100 rounded-lg shadow-md text-gray-700 w-64 hidden"></div>
                </div>
            </div>

            <!-- Chart for 6-Rep Cohort -->
            <div class="chart-wrapper relative p-4">
                <h2 class="text-xl font-bold text-gray-700 text-center mb-4">6-Rep Cohort Model</h2>
                <div class="relative h-[400px]">
                    <canvas id="chart6Reps"></canvas>
                    <div id="infoBox6" class="absolute top-4 left-4 p-4 bg-gray-100 rounded-lg shadow-md text-gray-700 w-64 hidden"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chart.js and Annotation Plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    
    <script>
        // Financial data for a 10-person cohort
        const cost10Reps = 34640;
        const idealRev10 = 24000;
        const likelyRev10 = 16000;
        const poorRev10 = 8000;
        const ambiguousRev10 = [6000, 18000, 10000, 22000, 14000, 25000, 12000, 28000, 15000, 30000, 18000, 35000];

        // Financial data for a 6-person cohort
        const cost6Reps = 20784;
        const idealRev6 = 14400;
        const likelyRev6 = 9600;
        const poorRev6 = 4800;
        const ambiguousRev6 = [3600, 10800, 6000, 13200, 8400, 15000, 7200, 16800, 9000, 18000, 10800, 21000];

        const labels = ['Month 1', 'Month 2', 'Month 3', 'Month 4', 'Month 5', 'Month 6', 'Month 7', 'Month 8', 'Month 9', 'Month 10', 'Month 11', 'Month 12'];

        // Helper function to calculate cumulative data
        const calculateCumulative = (monthlyData) => {
            let total = 0;
            return monthlyData.map((revenue, i) => {
                total += revenue * (i + 1);
                return total;
            });
        };

        const cumulativeCost10 = labels.map((_, i) => (i + 1) * cost10Reps);
        const cumulativeIdealRev10 = calculateCumulative(Array(12).fill(idealRev10));
        const cumulativeLikelyRev10 = calculateCumulative(Array(12).fill(likelyRev10));
        const cumulativePoorRev10 = calculateCumulative(Array(12).fill(poorRev10));
        const cumulativeAmbiguousRev10 = calculateCumulative(ambiguousRev10);

        const cumulativeCost6 = labels.map((_, i) => (i + 1) * cost6Reps);
        const cumulativeIdealRev6 = calculateCumulative(Array(12).fill(idealRev6));
        const cumulativeLikelyRev6 = calculateCumulative(Array(12).fill(likelyRev6));
        const cumulativePoorRev6 = calculateCumulative(Array(12).fill(poorRev6));
        const cumulativeAmbiguousRev6 = calculateCumulative(ambiguousRev6);
        
        const breakEvenPoints = {
            '10-Rep Ideal Model': 2,
            '10-Rep Likely Model': 4,
            '10-Rep Poor Model': 8,
            '10-Rep Ambiguous Model': 4,
            '6-Rep Ideal Model': 2,
            '6-Rep Likely Model': 4,
            '6-Rep Poor Model': 8,
            '6-Rep Ambiguous Model': 4
        };

        const chartColors = {
            cost: 'rgb(248, 113, 113)',
            ideal: 'rgb(34, 197, 94)',
            likely: 'rgb(59, 130, 246)',
            poor: 'rgb(251, 191, 36)',
            ambiguous: 'rgb(108, 117, 125)'
        };

        const createChart = (canvasId, titlePrefix, costData, idealData, likelyData, poorData, ambiguousData, infoBoxId) => {
            const ctx = document.getElementById(canvasId).getContext('2d');
            return new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Cumulative Costs',
                        data: costData,
                        borderColor: chartColors.cost,
                        backgroundColor: chartColors.cost,
                        borderWidth: 3,
                        fill: false,
                        tension: 0.1
                    }, {
                        label: `${titlePrefix} Ideal Model`,
                        data: idealData,
                        borderColor: chartColors.ideal,
                        backgroundColor: chartColors.ideal,
                        borderWidth: 3,
                        fill: false,
                        tension: 0.1
                    }, {
                        label: `${titlePrefix} Likely Model`,
                        data: likelyData,
                        borderColor: chartColors.likely,
                        backgroundColor: chartColors.likely,
                        borderWidth: 3,
                        fill: false,
                        tension: 0.1
                    }, {
                        label: `${titlePrefix} Poor Model`,
                        data: poorData,
                        borderColor: chartColors.poor,
                        backgroundColor: chartColors.poor,
                        borderWidth: 3,
                        fill: false,
                        tension: 0.1
                    }, {
                        label: `${titlePrefix} Ambiguous Model`,
                        data: ambiguousData,
                        borderColor: chartColors.ambiguous,
                        backgroundColor: chartColors.ambiguous,
                        borderWidth: 3,
                        fill: false,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cumulative Value ($)',
                                font: { size: 16, weight: 'bold' }
                            },
                            ticks: {
                                callback: (value) => '$' + value.toLocaleString()
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Timeline',
                                font: { size: 16, weight: 'bold' }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            onClick: (e, legendItem, legend) => {
                                Chart.defaults.plugins.legend.onClick(e, legendItem, legend);
                                updateChartAnnotations(legend.chart, legendItem.text, infoBoxId);
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: (context) => {
                                    let label = context.dataset.label || '';
                                    if (label) { label += ': '; }
                                    if (context.parsed.y !== null) { label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y); }
                                    return label;
                                }
                            }
                        },
                        annotation: { annotations: [] }
                    }
                }
            });
        };

        const chart10 = createChart('chart10Reps', '10-Rep', cumulativeCost10, cumulativeIdealRev10, cumulativeLikelyRev10, cumulativePoorRev10, cumulativeAmbiguousRev10, 'infoBox10');
        const chart6 = createChart('chart6Reps', '6-Rep', cumulativeCost6, cumulativeIdealRev6, cumulativeLikelyRev6, cumulativePoorRev6, cumulativeAmbiguousRev6, 'infoBox6');

        const updateChartAnnotations = (chart, modelLabel, infoBoxId) => {
            const annotations = [];
            const infoBox = document.getElementById(infoBoxId);
            infoBox.style.display = 'none';

            if (modelLabel.includes('Model')) {
                const breakEvenMonth = breakEvenPoints[modelLabel];
                if (breakEvenMonth) {
                    let yCost = chart.data.datasets[0].data[breakEvenMonth - 1];
                    annotations.push({
                        type: 'point',
                        xValue: labels[breakEvenMonth - 1],
                        yValue: yCost,
                        backgroundColor: 'rgba(255, 99, 132, 1)',
                        borderColor: 'rgba(255, 99, 132, 1)',
                        borderWidth: 2,
                        radius: 8,
                        label: {
                            content: 'Break-Even',
                            enabled: true,
                            position: 'start'
                        }
                    });
                }
            }
            
            let infoText = '';
            if (modelLabel.includes('Ideal Model')) {
                infoText = `This is the **Ideal Model**. The program is a home run, becoming profitable in **Month 2**.`;
            } else if (modelLabel.includes('Likely Model')) {
                infoText = `This is the **Likely Model**. The program breaks even in **Month 4**. The **Bailout Point** is Month 1.`;
            } else if (modelLabel.includes('Poor Model')) {
                infoText = `This is the **Poor Model**. It takes until **Month 8** to break even. The **Bailout Point** is at Month 1.`;
            } else if (modelLabel.includes('Ambiguous Model')) {
                infoText = `This is the **Ambiguous Model**. Performance is sporadic and it breaks even in **Month 4**. The **Bailout Point** is at Month 1.`;
            }
            
            if (infoText) {
                infoBox.innerHTML = infoText;
                infoBox.style.display = 'block';
            }

            chart.options.plugins.annotation.annotations = annotations;
            chart.update();
        };

        const resetChartAnnotations = (chart, infoBoxId) => {
            chart.options.plugins.annotation.annotations = [];
            document.getElementById(infoBoxId).style.display = 'none';
            chart.update();
        };

        document.getElementById('chart10Reps').addEventListener('click', (e) => {
            const legend = Chart.getChart('chart10Reps').legend;
            legend.options.onClick(e, null, legend);
        });

        document.getElementById('chart6Reps').addEventListener('click', (e) => {
            const legend = Chart.getChart('chart6Reps').legend;
            legend.options.onClick(e, null, legend);
        });
    </script>
</body>
</html>
